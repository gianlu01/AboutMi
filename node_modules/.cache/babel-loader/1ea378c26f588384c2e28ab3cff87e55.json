{"ast":null,"code":"var constrainFeatureMovement = require('./constrain_feature_movement');\n\nvar Constants = require('../constants');\n\nmodule.exports = function (features, delta) {\n  var constrainedDelta = constrainFeatureMovement(features.map(function (feature) {\n    return feature.toGeoJSON();\n  }), delta);\n  features.forEach(function (feature) {\n    var currentCoordinates = feature.getCoordinates();\n\n    var moveCoordinate = function moveCoordinate(coord) {\n      var point = {\n        lng: coord[0] + constrainedDelta.lng,\n        lat: coord[1] + constrainedDelta.lat\n      };\n      return [point.lng, point.lat];\n    };\n\n    var moveRing = function moveRing(ring) {\n      return ring.map(function (coord) {\n        return moveCoordinate(coord);\n      });\n    };\n\n    var moveMultiPolygon = function moveMultiPolygon(multi) {\n      return multi.map(function (ring) {\n        return moveRing(ring);\n      });\n    };\n\n    var nextCoordinates;\n\n    if (feature.type === Constants.geojsonTypes.POINT) {\n      nextCoordinates = moveCoordinate(currentCoordinates);\n    } else if (feature.type === Constants.geojsonTypes.LINE_STRING || feature.type === Constants.geojsonTypes.MULTI_POINT) {\n      nextCoordinates = currentCoordinates.map(moveCoordinate);\n    } else if (feature.type === Constants.geojsonTypes.POLYGON || feature.type === Constants.geojsonTypes.MULTI_LINE_STRING) {\n      nextCoordinates = currentCoordinates.map(moveRing);\n    } else if (feature.type === Constants.geojsonTypes.MULTI_POLYGON) {\n      nextCoordinates = currentCoordinates.map(moveMultiPolygon);\n    }\n\n    feature.incomingCoords(nextCoordinates);\n  });\n};","map":null,"metadata":{},"sourceType":"script"}